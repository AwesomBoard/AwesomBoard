<svg xmlns="http://www.w3.org/2000/svg"
     width="100%" height="auto"
     [attr.viewBox]="(-STROKE_WIDTH) + ' 0 ' + BOARD_WIDTH + ' ' + BOARD_HEIGHT"
     [attr.transform]="rotation"
     preserveAspectRatio="xMidYMid meet">

    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7"
                refX="5" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" />
        </marker>
        <marker id="arrowhead-moved" markerWidth="10" markerHeight="7"
                refX="5" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" class="moved-fill moved-stroke"/>
        </marker>
    </defs>

    <g *ngFor="let space of getAllCoords()">
        <g (click)="onClick(space)"
           id="click_{{ space.x }}_{{ space.y }}">
           <polygon id="case_{{ space.x }}_{{ space.y }}"
                    class="base"
                    [ngClass]="getSpaceClass(space)"
                    [attr.points]="getHexaCoordsAt(space)"
                    stroke-linecap="round"/>
            <circle *ngIf="isPiece(space)"
                    class="base"
                    [ngClass]="getPieceClass(space)"
                    [attr.cx]="getCenterAt(space).x"
                    [attr.cy]="getCenterAt(space).y"
                    [attr.r]="SPACE_SIZE"/>
        </g>
    </g>

    <g *ngFor="let capture of possibleCaptures; index as i"
       class="capturable"
       pointer-events="fill">
        <polygon *ngFor="let space of capture.capturedSpaces"
                 class="no-fill"
                 (click)="onClick(space)"
                 [attr.points]="getHexaCoordsAt(space)"
                 stroke-linecap="round" />
    </g>

    <g *ngFor="let arrow of arrows">
        <line [attr.x1]="arrow.x1"
              [attr.y1]="arrow.y1"
              [attr.x2]="arrow.x2"
              [attr.y2]="arrow.y2"
              class="arrow"
              marker-end="url(#arrowhead)"
              (click)="onClick(arrow.destination)"/>
    </g>

    <g *ngFor="let player of Player.PLAYERS">
        <g *ngFor="let p of getPlayerSidePieces(player)">
            <circle id="piece_{{ player.value }}_{{ p }}"
                    [attr.cx]="getRemainingPieceCx(player, p)"
                    [attr.cy]="getRemainingPieceCy(player)"
                    [attr.r]="SPACE_SIZE * 0.5"
                    [ngClass]="getPlayerClass(player)"
                    class="base small-stroke"
            />
        </g>
    </g>

    <line *ngIf="inserted.isPresent()"
          [attr.x1]="inserted.get().x1"
          [attr.y1]="inserted.get().y1"
          [attr.x2]="inserted.get().x2"
          [attr.y2]="inserted.get().y2"
          class="arrow moved-stroke"
          marker-end="url(#arrowhead-moved)"
    />
</svg>
