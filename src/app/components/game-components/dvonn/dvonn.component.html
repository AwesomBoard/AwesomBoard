<svg xmlns="http://www.w3.org/2000/svg"
     width="100%" height="auto"
     viewBox="0 0 850 400"
     preserveAspectRatio="xMidYMid meet">
    <!-- Show disconnecteds -->
    <g *ngFor="let disconnected of disconnecteds">
        <polyline [attr.points]="getHexaCoordinates(center(disconnected.x, disconnected.y))"
                  style="stroke:red; fill: lightcoral"/>
        <circle id="captured_{{ disconnected.x }}_{{ disconnected.y }}"
                [attr.cx] = "center(disconnected.x, disconnected.y).x"
                [attr.cy] = "center(disconnected.x, disconnected.y).y"
                [attr.r]="CASE_SIZE/3"
                style="stroke-width: 2;"
                fill-opacity="0.75"
                [ngStyle]="stylePiece(disconnected.caseContent, false)"/>
        <text *ngIf="size(disconnected.caseContent) > 1"
              [attr.x]="center(disconnected.x, disconnected.y).x"
              [attr.y]="center(disconnected.x, disconnected.y).y"
              text-anchor="middle"
              stroke="black"
              stroke-width="2"
              dy=".3em">{{pieceText(disconnected.caseContent)}}</text>
    </g>
    <g *ngFor="let line of board; index as y;">
        <g *ngFor="let caseContent of line; index as x;">
            <g *ngIf="isOnBoard(x, y)">
                <!-- Background -->
                <polyline [attr.points]="getHexaCoordinates(center(x, y))"
                          fill="none"
                          style="stroke:black"/>
                <!-- Piece -->
                <circle *ngIf="isSource(caseContent) else nonSource"
                        id="click_{{ x }}_{{ y }}"
                        (click)="onClick(x, y)"
                        [attr.cx] = "center(x, y).x"
                        [attr.cy] = "center(x, y).y"
                        [attr.r]="CASE_SIZE/4"
                        [ngStyle]="stylePiece(caseContent, true)"/>
                <ng-template #nonSource>
                    <circle *ngIf="size(caseContent) > 0"
                            id="click_{{ x }}_{{ y }}"
                            (click)="onClick(x, y)"
                            [attr.cx] = "center(x, y).x"
                            [attr.cy] = "center(x, y).y"
                            [attr.r]="CASE_SIZE/3"
                            style="stroke-width: 5;"
                            [ngStyle]="stylePiece(caseContent, false)"/>
                </ng-template>
                <text *ngIf="size(caseContent) > 1"
                      (click)="onClick(x, y)"
                      [attr.x]="center(x, y).x"
                      [attr.y]="center(x, y).y"
                      text-anchor="middle"
                      stroke="#51c5cf"
                      stroke-width="2"
                      dy=".3em">{{pieceText(caseContent)}}</text>
            </g>
        </g>
    </g>
    <!-- Highlight last move -->
    <ng-container *ngIf="lastMove !== null">
        <polyline [attr.points]="getHexaCoordinates(center(lastMove.coord.x, lastMove.coord.y))"
                  style="fill:none; stroke:blue; stroke-width:5;"/>
        <polyline [attr.points]="getHexaCoordinates(center(lastMove.end.x, lastMove.end.y))"
                  style="fill:none; stroke:blue; stroke-width:5;"/>
    </ng-container>
    <!-- Highlight selected piece -->
    <polyline *ngIf="chosen !== null"
              [attr.points]="getHexaCoordinates(center(chosen.x, chosen.y))"
              style="fill:none; stroke:#e6e600;stroke-width:5;"/>
</svg>
