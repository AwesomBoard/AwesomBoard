<div class="container-fluid"
	 style="height: 88%; max-height: 88%">

	<app-part-creation id="partCreation"
					   *ngIf="gameStarted === false"
					   [partId]="partId"
					   [userName]="userName"
					   (gameStartNotification)="startGame()">
	</app-part-creation>

	<div id="game"
		 *ngIf="gameStarted === true"
		 class="container">

		<div id="info">
			<div>
				<h3 style="alignment: left"> {{ players[0] }} :
					<app-count-down (outOfTimeAction)="reachedOutOfTime(0)"
									[(duration)]="playerZeroRemainingTime"
									[(paused)]="!isPlayerZeroTurn"
									[initialDuration]="maximalMoveDuration">
					</app-count-down>
				</h3>
				<h3 style="alignment: right"> {{ players[1] }} :
					<app-count-down (outOfTimeAction)="reachedOutOfTime(1)"
									[(duration)]="playerOneRemainingTime"
									[(paused)]="!isPlayerOneTurn"
									[initialDuration]="maximalMoveDuration">
					</app-count-down>
				</h3>
			</div>
			<div *ngIf="opponent && observerRole <2">
				<h3> Vous jouez contre {{ opponent.user.pseudo }} </h3>
				<button *ngIf="!endGame" (click)="resign()"> Abandonner</button>
				<!-- <div *ngIf="allowedOutOfTimeVictory && !endGame">
					<h3>
						{{ opponent.user.pseudo }} ne réagit plus :
						<button (click)="notifyTimeoutVictory()">
							Victoire par timeout?
						</button>
					</h3>
				</div> -->
				<div> Tour : {{ turn }}</div>
			</div>
			<h3 *ngIf="observerRole>=2"> {{ players[0] }} vs {{ players[1] }}</h3>
			<h3 *ngIf="(!endGame) && (currentPlayer!==userName)"> C'est au tour de {{ currentPlayer }} </h3>
			<h3 *ngIf="(!endGame) && (currentPlayer===userName)"> C'est à votre tour ! </h3>
			<div *ngIf="endGame">
				<div *ngIf="winner != null">
					<h3 *ngIf="(winner === userName)"> Vous avez gagné </h3>
					<h3 *ngIf="(winner !== userName) && (observerRole < 2)"> Vous avez perdu face à {{ winner }}</h3>
					<h3 *ngIf="(winner !== userName) && (observerRole >= 2)"> Victoire de {{ winner }} </h3>
				</div>
				<div *ngIf="winner === null">
					<h3> Match nul </h3>
				</div>
				<button (click)="backToServer()">Retour au serveur</button>
			</div>
		</div>

		<div id="board">
			<table>
				<tr *ngFor="let line of board; index as y;">
					<td *ngFor="let case of line; index as x;"
						style="position:relative;"
						(click)="onClick(x);">
						<img width="50" height="50"
							 id="{{'t'+y+x}}"
							 alt=":{{ case }}:"
							 [src]='imagesLocation+imagesNames[case]'/>
						<img *ngIf="lastX===x"
							 width="50" height="50"
							 id="{{'u'+y+x}}"
							 alt="highlighted"
							 [src]="imagesLocation+'highlight.svg'"
							 style="position:absolute; top:0; left:0;"/>
					</td>
				</tr>
			</table>
		</div>

	</div>

	<div id="chat" class="circled" style="height: 40%; max-height: 40%; float: bottom;">
		<app-chat [userName]="userName"
				  [chatId]="partId"
				  [turn]="turn"></app-chat>
	</div>

</div>
